
# files
GENOME: "/home/fangzq/genome/mouse/GRCm38_68.fa"
dbSNP: "/home/fangzq/genome/mouse/mgp.v5.merged.snps_all.dbSNP142.sorted.vcf"
dbINDEL: "/home/fangzq/genome/mouse/mgp.v5.merged.indels.dbSNP142.normed.vcf"
BAM_DIR: "/data/bases/fangzq/strains"
TMPDIR: "/home/fangzq/TMPDATA"
VEP: "/home/fangzq/github/ensembl-vep"

# raw fastq files
FASTQS:
    PATH: ""
    # regex pattern of fastq files
    # exact 3 group for example: name, lane
    R1: "([A-Z0-9-]+)_(L[0-9]{3})_R1_[0-9]{3}.fastq.gz"
    R2: "([A-Z0-9-]+)_(L[0-9]{3})_R2_[0-9]{3}.fastq.gz"

STRAINS: ['129P2', '129S1', '129S5', 'AKR', 'A_J', 'B10', 
        'BPL', 'BPN', 'BTBR', 'BUB', 'BALB', 'C3H', 'C57BL10J',
        'C57BL6NJ', 'C57BRcd', 'C57LJ', 'C58', 'CBA', 'CEJ', 
        'DBA', 'DBA1J', 'FVB', 'ILNJ', 'KK', 'LGJ', 'LPJ', 
        'MAMy', 'MRL','NOD', 'NON', 'NOR', 'NUJ', 'NZB', 'NZO', 'NZW', 
        'PJ', 'PLJ', 'RFJ', 'RHJ', 'RIIIS', 'SEA', 'SJL', 'SMJ', 'ST', 'SWR', 'TALLYHO', 'RBF',
        'CAST', 'MOLF', 'PWD','PWK', 'SPRET', 'WSB'] # the last 6 are wild-derived inbred strain

HBCGM:
    # working directory
    WORKSPACE: "/mnt/synology_share/HAPLOMAP_TEST"
    # path to haplomap
    BIN: "/home/fangzq/github/HBCGM/build/bin"
    
    # ghmap input
    # MPD trait ids 
    TRAIT_IDS: "/data/bases/shared/haplomap/new_test_ids.txt"
    # set to true if input individual animal data. Default: use strain means.   
    USE_RAWDATA: false 
    # use custom database instead of using MPD API to get data.
    TRAIT_DATA:  "" # default: MPD database
    # genetic relation file from PLink output
    GENETIC_REL: "/data/bases/shared/haplomap/PELTZ_20200429/mouse54_grm.rel"
    GENETIC_REL_ID: "/data/bases/shared/haplomap/PELTZ_20200429/mouse54_grm.rel.id"
    # gene expression file
    GENE_EXPRS: "/data/bases/shared/haplomap/PELTZ_20200429/mus.compact.exprs.txt"
    # open chromatin regions to annotate haploblocks.
    ATAC_PEAKS: "/scratch/users/fangzq/MouseEpigenomeAtlas/beds/*.blacklist_removed.broadPeak"

    # eblock input
    # strains metadata. 
    STRAIN_ANNO: "/data/bases/shared/haplomap/PELTZ_20200429/strains.metadata.csv"
    # path to SNP database
    SNPS_DIR: "/data/bases/shared/haplomap/PELTZ_20200429/SNPs"
    # PATH to SNP annotations for all genes
    ANNOVAR: "/data/bases/shared/haplomap/PELTZ_20200429/SNP_Annotation" 
    # snp, geneid,genename mapping
    KNOWNGENE_META: "/data/bases/shared/haplomap/PELTZ_20200429/SNP_Annotation/mm10_kgXref.txt" 
    KNOWNGENE: "/data/bases/shared/haplomap/PELTZ_20200429/SNP_Annotation/mm10_knownGene.txt" 


BCFTOOLS:
    WORKSPACE: "/data/bases/fangzq/20200429_BCFTOOLS"
    qual: 50 
    phred_likelihood_diff: 20

GATK:
    WORKSPACE: "/data/bases/fangzq/20200430_GATK"
    qual: 50 
    phred_likelihood_diff: 20
    # for hardfilering, no implemented yet
    snp:
        - "-filter 'QD < 2.0' --filter-name 'QD2' " 
        - "-filter 'QUAL < 30.0' --filter-name 'QUAL30' " 
        - "-filter 'SOR > 3.0' --filter-name 'SOR3' " 
        - "-filter 'FS > 60.0' --filter-name 'FS60' " 
        - "-filter 'MQ < 40.0' --filter-name 'MQ40' " 
        - "-filter 'MQRankSum < -12.5' --filter-name 'MQRankSum-12.5' " 
        - "-filter 'ReadPosRankSum < -8.0' --filter-name 'ReadPosRankSum-8' " 
    indel:
        - "-filter 'QD < 2.0' --filter-name 'QD2' " 
        - "-filter 'QUAL < 30.0' --filter-name 'QUAL30' " 
        - "-filter 'FS > 200.0' --filter-name 'FS200' " 
        - "-filter 'ReadPosRankSum < -20.0' --filter-name 'ReadPosRankSum-20' " 

        ## see this paper: PMID: 25917818
        ## GATK UnifiedGenotyper at parameters, -stand_call_conf 50.0, -stand_emit_conf 30.0, -dt NONE. 
        ##  GATK VariantFiltration based on the following parameters: 
        # LowCoverage (DP < 5), 
        # LowQual (30 < Q < 50), VeryLowQual (Q < 30), 
        # StrandBias (FS P-value > 60), 
        # SNV cluster (three or more SNVs within 10 bp), Poor Mapping quality (>10% of reads have nonunique alignments)


# Next we used the Variant Quality Score Recalibrator (VQSR) from the GATK for variant filtration, where
# we used the set of variants present on the Affymetrix Mouse Diversity Genotyping Array (PMID: 19668205) as a set
# of true positive variation5. We used the annotations “HRun”, “HaplotypeScore”, “DP”, “QD”,
# “FS”, “MQ”, “MQRankSum”, and “ReadPosRankSum” to train the VQSR, and we used a
# sensitivity threshold of 90% for the true positive set to define the set of newly genotyped sites
# that passed VQSR filtration.

    
    

